from django.db import models

from locations.models import City

# Create your models here.


class Language(models.Model):
    # id autogenerated by django
    name = models.CharField(max_length=255)

    def __str__(self):
        return self.name


class Facility(models.Model):
    # id autogenerated by django
    name = models.CharField(max_length=255)
    icon = models.ImageField(upload_to='schools/facilities', null=True, blank=True)

    def __str__(self):
        return self.name
    

class Acreditation(models.Model):
    name = models.CharField(max_length=255)
    logo = models.ImageField(upload_to='schools/Acreditations', null=True, blank=True)

    def __str__(self):
        return self.name


class Activity(models.Model):
    name = models.CharField(max_length=255)
    description = models.TextField(max_length=255, null=True, blank=True)
    img = models.ImageField(upload_to='schools/Activities', null=True, blank=True)

    def __str__(self):
        return self.name
    

class Activity(models.Model):
    name = models.CharField(max_length=255)
    description = models.TextField(max_length=255, null=True, blank=True)
    img = models.ImageField(upload_to='schools/Activities', null=True, blank=True)

    def __str__(self):
        return self.name


class Accommodation(models.Model):
    type = models.CharField(max_length=255)
    description = models.TextField(max_length=255, null=True, blank=True)
    img = models.ImageField(upload_to='schools/Accommodation', null=True, blank=True)

    def __str__(self):
        return self.type


class School(models.Model):
    """
    Main model
    """
    # id autogenerated by django
    language_id = models.ForeignKey(Language, on_delete=models.CASCADE)
    name =  models.CharField(max_length=255)
    description = models.TextField()
    facilities = models.ManyToManyField(Facility, through='SchoolFacility')
    acreditations = models.ManyToManyField(Acreditation, through='SchoolAcreditation')
    activities = models.ManyToManyField(Activity, through='SchoolActivity')

    def __str__(self):
        return self.name



class Address(models.Model):
    # id autogenerated by django
    city_id = models.ForeignKey(City, on_delete=models.CASCADE)
    street = models.CharField(max_length=255)
    street_number = models.CharField(max_length=20)
    post_code = models.CharField(max_length=20)

    def __str__(self):
        return self.street


class SchoolSocialNetwork(models.Model):
    pass


class SchoolContactInformation(models.Model):
    # id = PK autogenerated by django
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)
    address_id = models.ForeignKey(Address, on_delete=models.CASCADE)
    telephone = models.IntegerField()
    info_email = models.EmailField(max_length=255)
    bookings_email = models.EmailField(max_length=255)
    academics_email = models.EmailField(max_length=255)
    website = models.CharField(max_length=254)
    # social_networks = models.ForeignKey(SchoolSocialNetwork, on_delete=models.CASCADE)  VER BIEN DESPUES


class SchoolImg(models.Model):
    # id autogenerated by django
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)
    img = models.ImageField(upload_to='schools/')
    description = models.CharField(max_length=255)
    alt = models.CharField(max_length=255)


class SchoolFacility(models.Model):
    """
    Asociative entity between School and Facility.
    """
    # id autogenerated by django
    facility_id = models.ForeignKey(Facility, on_delete=models.CASCADE)
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)


class SchoolAcreditation(models.Model):
    """
    Asociative entity between School and Acreditation.
    """
    # id autogenerated by django
    acreditation_id = models.ForeignKey(Acreditation, on_delete=models.CASCADE)
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)


class SchoolActivity(models.Model):
    """
    Asociative entity between School and Activity.
    """
    # id autogenerated by django
    activity_id = models.ForeignKey(Activity, on_delete=models.CASCADE)
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)


class SchoolAccommodation(models.Model):
    """
    Asociative entity between School and Accomodation.
    """
    # id autogenerated by django
    accommodation_id = models.ForeignKey(Accommodation, on_delete=models.CASCADE)
    school_id = models.ForeignKey(School, on_delete=models.CASCADE)
    name =  models.CharField(max_length=255)
    ls_week_price = models.DecimalField(decimal_places=2, max_digits=6) # ls = low season
    hs_week_price = models.DecimalField(decimal_places=2, max_digits=6) # hs = high season











